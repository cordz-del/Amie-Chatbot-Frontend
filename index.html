<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amie Chatbot</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico">
</head>
<body>
    <div id="main-container">
        <header>
            <h1 id="amie-title">Amie</h1>
        </header>

        <main>
            <div id="chat-container">
                <!-- Chat History -->
                <div id="chat-history" aria-label="Chat history" tabindex="0"></div>

                <!-- Input Section -->
                <section id="input-container">
                    <form id="chat-form" aria-label="Chat form">
                        <!-- Age Dropdown -->
                        <select id="age-dropdown" aria-label="Select your age">
                            <option value="" disabled selected>Age</option>
                            <script>
                                for (let i = 1; i <= 30; i++) {
                                    document.write(`<option value="${i}">${i}</option>`);
                                }
                            </script>
                        </select>

                        <!-- Message Input -->
                        <input 
                            type="text" 
                            id="chat-input" 
                            placeholder="Type your message here..." 
                            required 
                            aria-label="Enter your message"
                        >

                        <!-- Submit Button -->
                        <button type="submit" id="send-button" aria-label="Send your message">Send</button>
                    </form>
                </section>
            </div>
        </main>

        <footer>
            <p>Powered by Amie - AI for Social & Emotional Learning</p>
        </footer>
    </div>

    <!-- Bot Libre SDK Integration -->
    <script type="text/javascript" src="https://www.botlibre.com/scripts/sdk.js"></script>
    <script type="text/javascript">
        // Bot Libre Configuration
        const applicationId = "5657790313173565017"; // Replace with your Application ID
        const botId = "55654109"; // Replace with your Bot ID

        // Initialize Bot Libre Web Chat
        SDK.applicationId = applicationId;

        const webChat = new WebChatbotListener();
        webChat.instance = botId;
        webChat.instanceName = "Amie";
        webChat.prefix = "botplatform";
        webChat.caption = "Chat Now";
        webChat.boxLocation = "bottom-right";
        webChat.color = "#007bff"; // Customize button color
        webChat.background = "#fff"; // Customize background color
        webChat.bubble = true; // Enable chatbot bubble
        webChat.showMenubar = true;
        webChat.showBoxmax = true;
        webChat.avatar = true; // Show chatbot avatar
        webChat.chatLog = true; // Enable chat log
        webChat.popupURL = `https://www.botlibre.com/chat?id=${botId}&embedded=true&chatLog=true&application=${applicationId}`;

        webChat.createBox();
    </script>

    <script>
        // Handle form submission for user input
        const chatForm = document.getElementById("chat-form");
        const chatInput = document.getElementById("chat-input");
        const chatHistory = document.getElementById("chat-history");

        chatForm.addEventListener("submit", (event) => {
            event.preventDefault();
            const userMessage = chatInput.value.trim();
            if (!userMessage) return;

            // Display user message in the chat history
            const userMessageElement = document.createElement("div");
            userMessageElement.textContent = `You: ${userMessage}`;
            chatHistory.appendChild(userMessageElement);

            // Clear input field
            chatInput.value = "";

            // Send message to Bot Libre
            webChat.connection.sendMessage(userMessage);

            // Bot response handling will be done automatically by the SDK
        });
    </script>
</body>
</html>
